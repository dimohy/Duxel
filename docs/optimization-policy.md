# 성능 최적화 기록 정책

> 마지막 동기화: 2026-02-26

이 문서는 Duxel에서 성능/메모리 최적화를 수행할 때 **반드시 남겨야 하는 기록 기준**을 정의합니다.

## 1) 기록 원칙

- 최적화 1건마다 반드시 로그 1건을 남긴다.
- 로그는 "가설 → 변경 → 검증" 순서로 기록한다.
- 수치 검증은 가능한 한 동일 샘플/동일 옵션으로 A/B 비교한다.
- 결과가 음수(성능 하락)여도 숨기지 않고 그대로 기록한다.

## 2) 필수 로그 항목

각 항목을 누락 없이 기록한다.

- 날짜/세션 식별자
- 변경 영역 (파일/모듈)
- 최적화 유형 (GC, 풀링/재사용, 비동기화, 핫패스 리팩토링 등)
- 변경 요약 (1~3줄)
- 검증 명령어
- Before / After 수치
- 개선율(%)
- 리스크/후속 과제

## 3) 로그 저장 위치

- 정책 문서: `docs/optimization-policy.md`
- 세션 로그: `docs/optimization-session-YYYY-MM-DD.md`

## 4) 검증 기준

- 최소 1회 `dotnet build Duxel.slnx -c Release`
- 최소 1회 런타임 벤치 실행
  - 벡터: `./scripts/run-vector-clip-ab.ps1 ...`
  - 레이어 혼합: `./scripts/run-layer-widget-clip-ab.ps1 ...`
- 벤치 결과는 phase별 표와 평균 개선율(%)을 함께 기록

## 5) 표준 개선표 형식

| 항목 | 유형 | 대상 | 검증 | 결과 |
|---|---|---|---|---|
| 예시 | GC | `UiDrawCommand` | vector A/B | +1.2% |

## 6) 운영 규칙

- 새 최적화 PR/커밋에는 해당 세션 로그 링크를 포함한다.
- 동일 영역 재최적화 시 기존 로그를 덮지 않고 새 행을 추가한다.
- 측정이 어려운 구조 리팩토링은 정성 결과를 쓰되, 가능한 가장 근접한 지표를 함께 첨부한다.
